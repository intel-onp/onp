---
kolla_internal_vip_address: "{{ kolla_internal_vip_address }}"
kolla_external_vip_address: "{{ kolla_external_vip_address }}"
{% for group in ['control', 'network'] if group in groups %}
{% if kolla_internal_vip_address|string() != kolla_external_vip_address|string() %}
kolla_external_vip_interface: {{ node_info[groups[group][0]].networks['inter'].interface }}
{% endif %}
{% endfor %}

kolla_base_distro: "centos"
kolla_install_type: "source"
docker_registry: "{{ docker_registry }}"
docker_namespace: "{{ docker_namespace }}"
openstack_release: "{{ openstack_release }}"
openstack_logging_debug: "{{ openstack_logging_debug|default(False) }}"

{% set var = { 'public_inter' : "dummy1" } %}
{% for group in ['control', 'network'] if group in groups and "public" in node_info[groups[group][0]].networks %}
{% if var.update({ 'public_inter' : node_info[groups[group][0]].networks['public'].interface }) %} {% endif %}
{% endfor %}
neutron_external_interface: "{{ var.public_inter }}"

{% if use_ceilometer %}
enable_ceilometer: "yes"
enable_mongodb: "yes"
{% endif %}

{% if use_magnum %}
enable_magnum: "yes"
enable_cinder: "yes"
{% endif %}

{% if use_magnum and magnum_config.kubernetes['cinder_backend'] == "lvm" %}
enable_cinder_backend_lvm: "yes"
cinder_volume_group: "cinder-volumes"
{% elif use_magnum and magnum_config.kubernetes['cinder_backend'] == "nfs" %}
cinder_volume_driver: "nfs"
cinder_volume_group: "nfs-1"
{% endif %}

node_info:
  {{ node_info|to_yaml(indent=2, default_flow_style=False)|indent(2, false) }}
